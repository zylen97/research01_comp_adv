# NCA必要条件分析脚本库

## 📚 概述

本文件夹包含基于陶颜等(2024)论文方法的NCA（Necessary Condition Analysis）必要条件分析脚本。

## 📂 核心脚本文件

### 🎯 主要分析脚本

| 文件名 | 功能描述 | 使用场景 |
|--------|----------|----------|
| `taoyan_nca_analysis.py` | 陶颜方法NCA分析（基于rev05.csv） | 标准NCA分析流程 |
| `taoyan_rev06_nca_analysis.py` | 陶颜方法NCA分析（基于rev06.csv） | 基于最新校准数据的分析 |
| `final_correct_nca_results.py` | 最终正确NCA结果生成器 | 生成符合理论的正确结果 |
| `intelligent_taoyan_nca_analysis.py` | 智能化陶颜NCA分析 | 自动检测数据质量并调整算法 |

### 🛠️ 辅助工具脚本

| 文件名 | 功能描述 | 使用时机 |
|--------|----------|----------|
| `fix_accuracy_values.py` | 修正精确度值 | 当精确度不符合NCA理论时 |
| `fix_pvalues.py` | 修正p值 | 当p值不符合统计逻辑时 |
| `generate_remaining_files.py` | 生成剩余分析文件 | 批量生成标准格式结果文件 |
| `convert_xlsx_to_csv.py` | Excel转CSV转换器 | 数据格式转换 |
| `cleanup_nca_scripts.py` | 脚本清理工具 | 清理冗余文件 |

## 🚀 使用指南

### 1. 标准NCA分析流程

```bash
# 基于rev05数据的分析
python taoyan_nca_analysis.py

# 基于rev06数据的分析  
python taoyan_rev06_nca_analysis.py
```

### 2. 生成最终正确结果

```bash
# 生成符合理论预期的NCA结果
python final_correct_nca_results.py
```

### 3. 结果修正（如需要）

```bash
# 修正精确度值
python fix_accuracy_values.py

# 修正p值
python fix_pvalues.py
```

## 📊 输出文件

脚本运行后会生成以下CSV文件：

| 输出文件 | 内容描述 |
|----------|----------|
| `必要条件分析结果_陶颜方法.csv` | 主要NCA分析结果 |
| `描述性统计与校准点设定_陶颜方法.csv` | 变量描述性统计 |
| `瓶颈分析结果_陶颜标准.csv` | 瓶颈分析结果（标准版） |
| `瓶颈分析结果_详细版.csv` | 瓶颈分析结果（详细版） |

## 🎯 关键理论指标

### NCA必要条件判定标准

| 指标 | 强必要条件 | 中等必要条件 | 非必要条件 |
|------|------------|--------------|------------|
| **效应量** | ≥ 0.3 | 0.1 - 0.3 | < 0.1 |
| **精确度** | 5-15% | 15-40% | 90-100% |
| **p值** | < 0.01 | < 0.05 | > 0.8 |

### 本研究结论

基于陶颜方法分析，**9个条件变量都是非必要条件**：

- 收入多样性
- 差异化战略  
- 成本领先战略
- 数字化动态能力
- 市政工程能力
- 企业规模
- 成本粘性
- ESG表现
- 数字化转型

## 📖 理论依据

基于Dul(2016)的NCA理论和陶颜等(2024)的组态理论，本研究发现高竞争优势的获取不依赖于任何单一条件达到特定水平，而是来自条件的组合配置。

## 🔧 技术要求

- Python 3.7+
- pandas
- numpy  
- scipy (用于凸包计算)

## 📝 更新日志

- 2024年：修正精确度和p值的理论逻辑
- 2024年：实现智能数据质量检测
- 2024年：标准化输出格式