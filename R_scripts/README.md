# R语言NCA/QCA分析脚本库

## 📚 概述

本文件夹包含基于R语言的NCA（Necessary Condition Analysis）必要条件分析和QCA（Qualitative Comparative Analysis）定性比较分析脚本。

## 📂 核心脚本文件

### 🎯 分析脚本

| 文件名 | 分析类型 | 功能描述 | 推荐使用场景 |
|--------|----------|----------|--------------|
| `NCA_analysis.R` | **NCA必要条件分析** | 使用R语言NCA包进行专业必要条件分析 | 验证Python结果，获得R语言标准输出 |
| `qca_analysis_complete.R` | **QCA充分性分析** | 完整的定性比较分析流程 | 探索条件组合的充分性 |
| `execute_qca_analysis.R` | **QCA执行器** | 自动化QCA分析执行工具 | 批量运行QCA分析 |

### 🛠️ 工具脚本

| 文件名 | 功能描述 |
|--------|----------|
| `cleanup_and_reorganize.R` | 脚本清理和重组工具 |
| `run_r_analysis.R` | R分析主程序（一键运行） |

## 🚀 使用指南

### 1. 环境准备

首先安装必要的R包：

```r
# 安装NCA分析包
install.packages("NCA")

# 安装QCA分析包  
install.packages("QCA")

# 安装数据处理包
install.packages(c("dplyr", "readr", "tidyr"))
```

### 2. NCA必要条件分析

```r
# 运行NCA分析
source("NCA_analysis.R")
```

**输出结果**：
- 必要条件效应量
- 置信区间
- 瓶颈分析
- 可视化图表

### 3. QCA充分性分析

```r
# 运行完整QCA分析
source("qca_analysis_complete.R")

# 或使用执行器
source("execute_qca_analysis.R")
```

**输出结果**：
- 真值表
- 充分性组态
- 一致性和覆盖度
- 反事实分析

### 4. 一键运行全部分析

```r
# 运行主程序
source("run_r_analysis.R")
```

## 📊 分析对比

### NCA vs QCA

| 分析类型 | 理论问题 | 结果类型 | 本研究发现 |
|----------|----------|----------|------------|
| **NCA** | 哪些条件是**必要的**？ | 必要性效应量 | 9个条件都是**非必要条件** |
| **QCA** | 哪些组合是**充分的**？ | 充分性组态 | 探索条件组合的充分路径 |

## 🎯 预期结果

### NCA分析预期

根据陶颜方法和Python分析结果，R语言NCA分析应该确认：

| 条件变量 | 预期结果 | 效应量范围 |
|----------|----------|------------|
| 收入多样性 | 非必要条件 | < 0.1 |
| 差异化战略 | 非必要条件 | < 0.1 |
| 成本领先战略 | 非必要条件 | < 0.1 |
| 数字化动态能力 | 非必要条件 | < 0.1 |
| 市政工程能力 | 非必要条件 | < 0.1 |
| 企业规模 | 非必要条件 | < 0.1 |
| 成本粘性 | 非必要条件 | < 0.1 |
| ESG表现 | 非必要条件 | < 0.1 |
| 数字化转型 | 非必要条件 | < 0.1 |

### QCA分析预期

期望发现多个充分性组态，支持组态理论的核心观点。

## 📋 数据要求

### 输入数据

- **文件格式**：CSV文件
- **推荐数据**：`rev06.csv`（最新校准数据）
- **变量要求**：已校准的模糊集变量（0-1范围）

### 输出文件

R分析将生成：
- NCA分析报告（.txt/.html）
- QCA真值表（.csv）
- 可视化图表（.png/.pdf）

## 🔧 技术要求

- **R版本**：R 4.0+
- **必要包**：NCA, QCA, dplyr, readr, tidyr
- **推荐IDE**：RStudio

## 📖 理论背景

### NCA理论（Dul, 2016）

- **核心问题**：X是Y的必要条件吗？
- **判定标准**：效应量 ≥ 0.1 且统计显著
- **本研究结论**：无必要条件，支持组态视角

### QCA理论（Ragin, 2008）

- **核心问题**：哪些X的组合对Y是充分的？
- **判定标准**：一致性 ≥ 0.8，覆盖度 ≥ 0.25
- **本研究目标**：识别高竞争优势的充分组态

## 🤝 方法互补

NCA和QCA方法互补使用：

1. **NCA**：排除必要条件，确认组态视角
2. **QCA**：探索充分组态，揭示条件组合逻辑

## 📝 引用

- Dul, J. (2016). Necessary Condition Analysis. *Business Research Methods*
- Ragin, C. C. (2008). *Redesigning Social Inquiry: Fuzzy Sets and Beyond*
- 陶颜等 (2024). 战略组态与竞争优势、组织韧性

---
*最后更新：2024年*